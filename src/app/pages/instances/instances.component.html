<h2 style="margin:16px 0;">Timer Instances</h2>
<mat-card style="margin-bottom:12px;">
  <mat-card-content>
    <div style="display:flex; gap:8px; align-items:center; flex-wrap: wrap;">
      <button mat-raised-button color="primary" (click)="suspendSelected()" [disabled]="!selectedIds.length">Suspend</button>
      <button mat-raised-button color="primary" (click)="resumeSelected()" [disabled]="!selectedIds.length">Resume</button>
      <button mat-raised-button color="primary" (click)="triggerSelected()" [disabled]="!selectedIds.length">Trigger Now</button>
      
      <button 
        mat-raised-button 
        color="warn" 
        (click)="viewExecutions()" 
        [disabled]="selectedIds.length !== 1"
        style="margin-left: 8px;">
        📊 View Executions
      </button>
      
      <div style="margin-left: 16px; padding-left: 16px; border-left: 1px solid #ddd;">
        <span style="color:#777;">Selected: {{selectedIds.length}}</span>
      </div>
      
      <span style="margin-left:auto;">
        <button mat-button (click)="reload()">🔄 Refresh</button>
      </span>
    </div>
  </mat-card-content>
</mat-card>

<ag-grid-angular
  *ngIf="isBrowser"
  style="height: 70vh; width: 100%;"
  [rowData]="rowData"
  [columnDefs]="colDefs"
  [defaultColDef]="defaultColDef"
  [theme]="theme"
  [rowSelection]="{ mode: 'multiRow', checkboxes: true }"
  (gridReady)="onGridReady($event)"
  (selectionChanged)="onSelectionChanged($event)">
</ag-grid-angular>

<!-- Pagination Controls -->
<mat-card style="margin-top: 12px;">
  <mat-card-content>
    <div class="pagination-controls" style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 16px;">
      <!-- Page Size Selector -->
      <div class="page-size-selector" style="display: flex; align-items: center; gap: 8px;">
        <span style="color: #777;">Show:</span>
        <select 
          [value]="pageSize" 
          (change)="onPageSizeChange($event)">
          <option value="25">25</option>
          <option value="50">50</option>
          <option value="100">100</option>
          <option value="200">200</option>
        </select>
        <span style="color: #777;">per page</span>
      </div>

      <!-- Page Navigation -->
      <div class="page-navigation" style="display: flex; align-items: center; gap: 8px;">
        <button 
          mat-button 
          [disabled]="currentPage === 0 || isLoading"
          (click)="goToFirstPage()"
          title="First page">
          ⏮ First
        </button>
        
        <button 
          mat-button 
          [disabled]="currentPage === 0 || isLoading"
          (click)="previousPage()">
          ← Previous
        </button>
        
        <div style="display: flex; align-items: center; gap: 8px;">
          <span style="color: #777;">Page</span>
          <input 
            class="page-input"
            type="number" 
            [value]="currentPage + 1" 
            (change)="onPageInputChange($event)"
            (keyup)="onPageInputKeyup($event)"
            min="1" 
            [max]="totalPages || 1">
          <span style="color: #777;">of {{totalPages || '?'}}</span>
        </div>
        
        <button 
          mat-button 
          [disabled]="(totalPages > 0 && currentPage >= totalPages - 1) || isLoading"
          (click)="nextPage()">
          Next →
        </button>
        
        <button 
          mat-button 
          [disabled]="(totalPages > 0 && currentPage >= totalPages - 1) || isLoading"
          (click)="goToLastPage()"
          title="Last page">
          ⏭ Last
        </button>
      </div>

      <!-- Page Info -->
      <div class="page-info" style="display: flex; align-items: center; gap: 8px;">
        <span style="color: #777;">
          Showing {{(currentPage * pageSize) + 1}}-{{Math.min((currentPage + 1) * pageSize, totalItems)}} of {{totalItems || '?'}} instances
        </span>
        
        <button 
          mat-button 
          [disabled]="isLoading"
          (click)="reload()">
          🔄 Refresh
        </button>
        
        <button 
          mat-button 
          (click)="testPagination()"
          style="margin-left: 8px;">
          🧪 Test Pagination
        </button>
      </div>
    </div>

    <!-- Loading Indicator -->
    <div *ngIf="isLoading" class="loading-indicator">
      <span>Loading instances...</span>
    </div>
  </mat-card-content>
</mat-card>
